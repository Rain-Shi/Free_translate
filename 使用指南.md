# Word文档翻译工具 - 使用指南

## 🎉 应用已准备就绪！

您的Word文档翻译工具已经成功配置并运行。以下是完整的使用指南：

### 📍 访问应用
- **本地地址**: http://localhost:8501
- **网络地址**: http://192.168.1.125:8501

### 🔑 第一步：设置API密钥
1. 在浏览器中打开应用
2. 在左侧边栏找到"OpenAI设置"
3. 输入您的OpenAI API密钥
4. 点击确认

**重要提示**: 如果遇到"Client.init() got an unexpected keyword argument 'proxies'"错误，这是OpenAI库版本兼容性问题，应用已自动修复。请重新上传文档进行翻译。

### 📄 第二步：上传文档
1. 在"文件上传"区域
2. 点击"Browse files"或拖拽Word文档
3. 支持格式：.docx
4. 文件大小限制：200MB

### 🌍 第三步：选择翻译语言
在"目标语言"下拉菜单中选择：
- 中文
- 英文
- 日文
- 韩文
- 法文
- 德文
- 西班牙文
- 俄文

### ⚡ 第四步：自动处理
系统会自动执行以下步骤：
1. **转换格式**: Word → Markdown
2. **智能翻译**: 使用OpenAI GPT-3.5-turbo
3. **格式保持**: 保持原文档结构
4. **生成文档**: Markdown → Word

### 📥 第五步：下载结果
处理完成后，点击"下载翻译后的Word文档"按钮

## 🛠️ 技术特点

### ✨ 核心功能
- **精确Markdown提取**: 双重解析方法（Pandoc + 直接解析），确保内容提取准确
- **高质量翻译**: 使用OpenAI GPT模型
- **格式保持**: 最大程度保持原文档格式
- **智能处理**: 自动识别并保持Markdown语法
- **多语言支持**: 支持8种主要语言
- **质量监控**: 实时显示转换质量指标，确保提取准确性

### 🔧 技术栈
- **前端**: Streamlit现代化界面
- **文档处理**: python-docx + pypandoc
- **翻译引擎**: OpenAI GPT-3.5-turbo
- **格式转换**: Word ↔ Markdown ↔ Word

## ⚠️ 注意事项

### 📋 使用要求
- 需要有效的OpenAI API密钥
- 网络连接（用于API调用）
- 建议文档大小不超过10MB
- 复杂格式可能需要手动调整

### 💡 使用技巧
1. **文档准备**: 确保Word文档格式清晰
2. **语言选择**: 选择准确的目标语言
3. **质量检查**: 下载后检查翻译质量
4. **格式调整**: 必要时手动调整格式

## 🚀 快速启动

### Windows用户
```bash
# 双击运行
start_app.bat
```

### Linux/Mac用户
```bash
# 运行脚本
chmod +x start_app.sh
./start_app.sh
```

### 手动启动
```bash
# 激活虚拟环境
venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac

# 启动应用
streamlit run app.py
```

## 📞 技术支持

如果遇到问题，请检查：
1. 虚拟环境是否正确激活
2. 所有依赖包是否安装
3. OpenAI API密钥是否有效
4. 网络连接是否正常

### 🔧 常见问题解决

**问题1**: "openai.ChatCompletion is no longer supported"错误
- **解决方案**: 已降级到OpenAI 0.28.0版本，完全兼容

**问题2**: 翻译失败或返回原文本
- **解决方案**: 检查API密钥是否正确，网络连接是否正常

**问题3**: Word转Markdown失败
- **解决方案**: 确保文档格式正确，文件大小不超过限制

## 🎯 应用状态
✅ 所有依赖已安装  
✅ Pandoc已配置  
✅ 应用正在运行  
✅ 所有功能测试通过  

**现在您可以开始使用这个强大的Word文档翻译工具了！**
